{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as Permissions from \"expo-permissions\";\nimport React, { useEffect, useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport { TouchableOpacity } from \"react-native-gesture-handler\";\nimport DeletePhoto from \"../../assets/icons/deletePhoto.svg\";\nimport ImageCarousel from \"./ImageCarousel\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nvar verifyPermissionsCam = function () {\n  var _ref = _asyncToGenerator(function* () {\n    var result = yield Permissions.askAsync(Permissions.CAMERA);\n\n    if (result.status !== \"granted\") {\n      Alert.alert(\"Insufficient permissions!\", \"You need to grant camera permissions to use this app.\", [{\n        text: \"Okay\"\n      }]);\n      return false;\n    }\n\n    return true;\n  });\n\n  return function verifyPermissionsCam() {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nvar verifyPermissionsLib = function () {\n  var _ref2 = _asyncToGenerator(function* () {\n    var result = yield Permissions.askAsync(Permissions.MEDIA_LIBRARY);\n\n    if (result.status !== \"granted\") {\n      Alert.alert(\"Insufficient permissions!\", \"You need to grant camera permissions to use this app.\", [{\n        text: \"Okay\"\n      }]);\n      return false;\n    }\n\n    return true;\n  });\n\n  return function verifyPermissionsLib() {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\nvar takeImageHandlerLib = function () {\n  var _ref3 = _asyncToGenerator(function* (setPickedImages, onImageTaken) {\n    var hasPermission = yield verifyPermissionsLib();\n\n    if (!hasPermission) {\n      return;\n    }\n\n    var image = yield ImagePicker.launchImageLibraryAsync({\n      allowsEditing: true,\n      quality: 0.5\n    });\n\n    if (!image.cancelled) {\n      setPickedImages(function (images) {\n        return [].concat(_toConsumableArray(images), [image.uri]);\n      });\n      onImageTaken(image.uri);\n    }\n  });\n\n  return function takeImageHandlerLib(_x, _x2) {\n    return _ref3.apply(this, arguments);\n  };\n}();\n\nvar takeImageHandlerCam = function () {\n  var _ref4 = _asyncToGenerator(function* (setPickedImages, onImageTaken) {\n    var hasPermission = yield verifyPermissionsCam();\n\n    if (!hasPermission) {\n      return;\n    }\n\n    var image = yield ImagePicker.launchCameraAsync({\n      allowsEditing: true,\n      quality: 0.5\n    });\n    setPickedImages(function (images) {\n      return [].concat(_toConsumableArray(images), [image.uri]);\n    });\n    onImageTaken(image.uri);\n  });\n\n  return function takeImageHandlerCam(_x3, _x4) {\n    return _ref4.apply(this, arguments);\n  };\n}();\n\nvar deleteImage = function deleteImage(image, pickedImages, setPickedImages, onImageErased) {\n  var idx = pickedImages.indexOf(image);\n  pickedImages.splice(idx, 1);\n  setPickedImages(function (prev) {\n    return prev.splice(idx, 1);\n  });\n  onImageErased(pickedImages);\n};\n\nvar ImgPicker = function ImgPicker(_ref5) {\n  var onImageTaken = _ref5.onImageTaken,\n      onImageErased = _ref5.onImageErased,\n      defaultPhotos = _ref5.defaultPhotos,\n      IsEditable = _ref5.IsEditable,\n      onToggleSnackBar = _ref5.onToggleSnackBar;\n\n  var _useState = useState(defaultPhotos),\n      _useState2 = _slicedToArray(_useState, 2),\n      pickedImages = _useState2[0],\n      setPickedImages = _useState2[1];\n\n  useEffect(function () {\n    if (pickedImages === undefined) setPickedImages([]);\n  }, [pickedImages]);\n  return _jsx(View, {\n    style: styles.imagePicker,\n    children: IsEditable ? _jsx(View, {\n      children: _jsx(View, {\n        style: {\n          height: 148,\n          width: 360\n        },\n        children: _jsxs(ScrollView, {\n          showsHorizontalScrollIndicator: false,\n          horizontal: true,\n          style: {\n            height: 148\n          },\n          children: [_jsx(TouchableOpacity, {\n            onPress: function onPress() {\n              if (pickedImages.length >= 10) onToggleSnackBar();else takeImageHandlerLib(setPickedImages, onImageTaken);\n            },\n            style: styles.imagePreview,\n            children: _jsx(Text, {\n              style: {\n                fontSize: 35,\n                color: \"grey\"\n              },\n              children: \"+\"\n            })\n          }), pickedImages != null && pickedImages !== undefined ? pickedImages.map(function (image) {\n            return _jsxs(View, {\n              style: {\n                position: \"relative\",\n                marginRight: 164\n              },\n              children: [_jsx(Image, {\n                style: styles.image,\n                source: {\n                  uri: image\n                }\n              }), _jsx(View, {\n                onTouchEndCapture: function onTouchEndCapture() {\n                  deleteImage(image, pickedImages, setPickedImages, onImageErased);\n                },\n                style: {\n                  width: 24,\n                  height: 24,\n                  marginTop: 8,\n                  marginLeft: 116,\n                  position: \"absolute\"\n                },\n                children: _jsx(DeletePhoto, {})\n              })]\n            });\n          }) : _jsx(_Fragment, {})]\n        })\n      })\n    }) : pickedImages.length === 0 ? _jsx(_Fragment, {}) : _jsx(View, {\n      style: {\n        height: 148,\n        width: 360\n      },\n      children: _jsx(ImageCarousel, {\n        images: Object.values(pickedImages)\n      })\n    })\n  });\n};\n\nvar styles = StyleSheet.create({\n  imagePicker: {\n    alignItems: \"center\",\n    marginBottom: 15,\n    flexDirection: \"row\",\n    paddingLeft: 10\n  },\n  imagePreview: {\n    width: 148,\n    height: 148,\n    borderRadius: 10,\n    marginRight: 15,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderColor: \"#ccc\",\n    borderWidth: 1\n  },\n  image: {\n    width: 148,\n    height: 148,\n    borderRadius: 10,\n    marginRight: 15,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderColor: \"#ccc\",\n    borderWidth: 1,\n    position: \"absolute\"\n  }\n});\nexport default ImgPicker;","map":{"version":3,"names":["ImagePicker","Permissions","React","useEffect","useState","TouchableOpacity","DeletePhoto","ImageCarousel","verifyPermissionsCam","result","askAsync","CAMERA","status","Alert","alert","text","verifyPermissionsLib","MEDIA_LIBRARY","takeImageHandlerLib","setPickedImages","onImageTaken","hasPermission","image","launchImageLibraryAsync","allowsEditing","quality","cancelled","images","uri","takeImageHandlerCam","launchCameraAsync","deleteImage","pickedImages","onImageErased","idx","indexOf","splice","prev","ImgPicker","defaultPhotos","IsEditable","onToggleSnackBar","undefined","styles","imagePicker","height","width","length","imagePreview","fontSize","color","map","position","marginRight","marginTop","marginLeft","Object","values","StyleSheet","create","alignItems","marginBottom","flexDirection","paddingLeft","borderRadius","justifyContent","borderColor","borderWidth"],"sources":["/Users/jeongin/mapsee_2/components/EditScreen/ImgPicker.js"],"sourcesContent":["import * as ImagePicker from \"expo-image-picker\";\nimport * as Permissions from \"expo-permissions\";\nimport React, { useEffect, useState } from \"react\";\nimport {\n  View,\n  Button,\n  Text,\n  StyleSheet,\n  Image,\n  Alert,\n  ScrollView,\n} from \"react-native\";\nimport { TouchableOpacity } from \"react-native-gesture-handler\";\n\nimport DeletePhoto from \"../../assets/icons/deletePhoto.svg\";\nimport ImageCarousel from \"./ImageCarousel\";\nconst verifyPermissionsCam = async () => {\n  const result = await Permissions.askAsync(Permissions.CAMERA);\n  if (result.status !== \"granted\") {\n    Alert.alert(\n      \"Insufficient permissions!\",\n      \"You need to grant camera permissions to use this app.\",\n      [{ text: \"Okay\" }]\n    );\n    return false;\n  }\n  return true;\n};\n\nconst verifyPermissionsLib = async () => {\n  const result = await Permissions.askAsync(Permissions.MEDIA_LIBRARY);\n  if (result.status !== \"granted\") {\n    Alert.alert(\n      \"Insufficient permissions!\",\n      \"You need to grant camera permissions to use this app.\",\n      [{ text: \"Okay\" }]\n    );\n    return false;\n  }\n  return true;\n};\n\nconst takeImageHandlerLib = async (setPickedImages, onImageTaken) => {\n  const hasPermission = await verifyPermissionsLib();\n  if (!hasPermission) {\n    return;\n  }\n\n  const image = await ImagePicker.launchImageLibraryAsync({\n    allowsEditing: true,\n    quality: 0.5,\n  });\n\n  if (!image.cancelled) {\n    setPickedImages((images) => [...images, image.uri]);\n    onImageTaken(image.uri);\n  }\n};\n\nconst takeImageHandlerCam = async (setPickedImages, onImageTaken) => {\n  const hasPermission = await verifyPermissionsCam();\n  if (!hasPermission) {\n    return;\n  }\n\n  const image = await ImagePicker.launchCameraAsync({\n    allowsEditing: true,\n    quality: 0.5,\n  });\n\n  setPickedImages((images) => [...images, image.uri]);\n  onImageTaken(image.uri);\n};\n\nconst deleteImage = (image, pickedImages, setPickedImages, onImageErased) => {\n  const idx = pickedImages.indexOf(image); // findIndex = find + indexOf\n  pickedImages.splice(idx, 1);\n  setPickedImages((prev) => prev.splice(idx, 1));\n  onImageErased(pickedImages);\n};\n\nconst ImgPicker = ({\n  onImageTaken,\n  onImageErased,\n  defaultPhotos,\n  IsEditable,\n  onToggleSnackBar,\n}) => {\n  const [pickedImages, setPickedImages] = useState(defaultPhotos);\n  useEffect(() => {\n    if (pickedImages === undefined) setPickedImages([]);\n  }, [pickedImages]);\n  return (\n    <View style={styles.imagePicker}>\n      {IsEditable ? (\n        <View>\n          <View style={{ height: 148, width: 360 }}>\n            <ScrollView\n              showsHorizontalScrollIndicator={false}\n              horizontal\n              style={{ height: 148 }}\n            >\n              <TouchableOpacity\n                onPress={() => {\n                  if (pickedImages.length >= 10) onToggleSnackBar();\n                  else takeImageHandlerLib(setPickedImages, onImageTaken);\n                }}\n                style={styles.imagePreview}\n              >\n                <Text style={{ fontSize: 35, color: \"grey\" }}>+</Text>\n              </TouchableOpacity>\n\n              {pickedImages != null && pickedImages !== undefined ? (\n                pickedImages.map((image) => {\n                  return (\n                    <View\n                      style={{\n                        position: \"relative\",\n                        marginRight: 164,\n                      }}\n                    >\n                      <Image style={styles.image} source={{ uri: image }} />\n                      <View\n                        onTouchEndCapture={() => {\n                          deleteImage(\n                            image,\n                            pickedImages,\n                            setPickedImages,\n                            onImageErased\n                          );\n                        }}\n                        style={{\n                          width: 24,\n                          height: 24,\n                          marginTop: 8,\n                          marginLeft: 116,\n                          position: \"absolute\",\n                        }}\n                      >\n                        <DeletePhoto />\n                      </View>\n                    </View>\n                  );\n                })\n              ) : (\n                <></>\n              )}\n            </ScrollView>\n          </View>\n        </View>\n      ) : pickedImages.length === 0 ? (\n        <></>\n      ) : (\n        <View style={{ height: 148, width: 360 }}>\n          <ImageCarousel images={Object.values(pickedImages)} />\n        </View>\n      )}\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  imagePicker: {\n    alignItems: \"center\",\n    marginBottom: 15,\n    flexDirection: \"row\",\n    paddingLeft: 10,\n  },\n  imagePreview: {\n    width: 148,\n    height: 148,\n    borderRadius: 10,\n    //marginBottom:10,\n    marginRight: 15,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderColor: \"#ccc\",\n    borderWidth: 1,\n  },\n  image: {\n    width: 148,\n    height: 148,\n    borderRadius: 10,\n    //marginBottom:10,\n    marginRight: 15,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderColor: \"#ccc\",\n    borderWidth: 1,\n    position: \"absolute\",\n  },\n});\n\nexport default ImgPicker;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}